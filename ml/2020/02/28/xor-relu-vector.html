<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>XOR RELU forward propagation | Sustainability Lab Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="XOR RELU forward propagation" />
<meta name="author" content="Nipun Batra" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A programming introduc" />
<meta property="og:description" content="A programming introduc" />
<link rel="canonical" href="https://nipunbatra.github.io/blog/ml/2020/02/28/xor-relu-vector.html" />
<meta property="og:url" content="https://nipunbatra.github.io/blog/ml/2020/02/28/xor-relu-vector.html" />
<meta property="og:site_name" content="Sustainability Lab Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-28T00:00:00-06:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Nipun Batra"},"description":"A programming introduc","@type":"BlogPosting","headline":"XOR RELU forward propagation","dateModified":"2020-02-28T00:00:00-06:00","url":"https://nipunbatra.github.io/blog/ml/2020/02/28/xor-relu-vector.html","datePublished":"2020-02-28T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nipunbatra.github.io/blog/ml/2020/02/28/xor-relu-vector.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="/blog/assets/main.css">
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://nipunbatra.github.io/blog/feed.xml" title="Sustainability Lab Blog" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head><body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Sustainability Lab Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">XOR RELU forward propagation</h1><p class="page-description">A programming introduc</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-02-28T00:00:00-06:00" itemprop="datePublished">
        Feb 28, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Nipun Batra</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      14 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#ML">ML</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">
<a href="https://github.com/nipunbatra/blog/tree/master/_notebooks/2020-02-28-xor-relu-vector.ipynb" role="button">
    <img class="notebook-badge-image" src="https://img.shields.io/static/v1?label=&message=View%20On%20GitHub&color=586069&logo=github&labelColor=2f363d">
</a>
</div><div class="px-2">
    <a href="https://colab.research.google.com/github/nipunbatra/blog/blob/master/_notebooks/2020-02-28-xor-relu-vector.ipynb">
        <img class="notebook-badge-image" src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#Both-the-above-seem-correct">Both the above seem correct </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-28-xor-relu-vector.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">autograd.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
             <span class="p">])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((4, 2), (4, 1))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="p">,</span> <span class="n">N_0</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="n">N</span><span class="p">,</span> <span class="n">N_2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="n">N_1</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])]</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">]])]</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
<span class="n">A</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)))</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">assert</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N_0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">@</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
[[0 0]
 [1 0]
 [1 0]
 [2 1]] [[0 0]
 [1 0]
 [1 0]
 [2 1]]
2
[[0]
 [1]
 [1]
 [0]] [[0]
 [1]
 [1]
 [0]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3, 3)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Excellent, now let us start from random weight initialisations and use backprop to come to our result</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">activations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'sigmoid'</span><span class="p">,</span><span class="s1">'sigmoid'</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">relu</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">temp</span><span class="p">[</span><span class="n">temp</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">temp</span>

<span class="n">activation_func</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'sigmoid'</span><span class="p">:</span><span class="n">sigmoid</span><span class="p">,</span> <span class="s1">'relu'</span><span class="p">:</span><span class="n">relu</span><span class="p">}</span>

<span class="n">N</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="n">N1</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)):</span>
    <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">shapes</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    
<span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
<span class="n">A</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([[0, 0],
        [0, 1],
        [1, 0],
        [1, 1]]), None, None]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">@</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">activation_func</span><span class="p">[</span><span class="n">activations</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]](</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
[[ 1.86755799e+00 -9.77277880e-01]
 [ 2.26771520e+00  1.26361532e+00]
 [ 3.63161034e+00  1.46010423e-03]
 [ 4.03176754e+00  2.24235330e+00]] [[0.86617546 0.27343225]
 [0.9061677  0.77964784]
 [0.97420925 0.50036503]
 [0.98256638 0.9039889 ]]
2
[[0.67833848]
 [0.63971526]
 [0.74663222]
 [0.69348085]] [[0.66336776]
 [0.65468909]
 [0.67844443]
 [0.66674081]]
2.9991464995409807
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">alpha</span> <span class="o">=</span><span class="mi">1</span>

<span class="n">del_Z</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">del_A</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">del_W</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">del_b</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">@</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">activation_func</span><span class="p">[</span><span class="n">activations</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]](</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">y_hat</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y_hat</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y_hat</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
        
    <span class="n">del_A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">del_Z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y</span>
    <span class="n">del_W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="nd">@A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">del_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">del_Z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">del_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">del_Z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="nd">@W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">del_Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">del_A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">del_W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">del_Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="nd">@A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">del_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">del_Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="n">del_W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="n">del_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1">#print(W, b)</span>
        
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 1.900917288811307
2 1.8990782101635078
1 1.8990782101635078
2 1.895087705042622
1 1.895087705042622
2 1.8905198878127458
1 1.8905198878127458
2 1.8852422633948591
1 1.8852422633948591
2 1.8790824426514607
1 1.8790824426514607
2 1.87181365673781
1 1.87181365673781
2 1.8631340070326043
1 1.8631340070326043
2 1.852637598542766
1 1.852637598542766
2 1.8397740259314084
1 1.8397740259314084
2 1.8237947995594221
1 1.8237947995594221
2 1.803687539628661
1 1.803687539628661
2 1.7781150772260836
1 1.7781150772260836
2 1.7454104412325124
1 1.7454104412325124
2 1.7037598684781243
1 1.7037598684781243
2 1.6518020587184286
1 1.6518020587184286
2 1.5898145191893995
1 1.5898145191893995
2 1.5209483016687049
1 1.5209483016687049
2 1.4507542405683878
1 1.4507542405683878
2 1.38405887020842
1 1.38405887020842
2 1.3222689315400031
1 1.3222689315400031
2 1.2641685598460128
1 1.2641685598460128
2 1.2081654145958272
1 1.2081654145958272
2 1.1533532272707079
1 1.1533532272707079
2 1.0994873114762564
1 1.0994873114762564
2 1.046690125558263
1 1.046690125558263
2 0.9952279975151028
1 0.9952279975151028
2 0.9453902899726143
1 0.9453902899726143
2 0.8974338249860934
1 0.8974338249860934
2 0.8515608284413865
1 0.8515608284413865
2 0.8079132993922127
1 0.8079132993922127
2 0.7665752187248198
1 0.7665752187248198
2 0.7275787055359979
1 0.7275787055359979
2 0.6909118973557102
1 0.6909118973557102
2 0.6565274315699723
1 0.6565274315699723
2 0.6243506647119799
1 0.6243506647119799
2 0.5942872123527785
1 0.5942872123527785
2 0.5662294820081436
1 0.5662294820081436
2 0.5400621325743324
1 0.5400621325743324
2 0.5156664384404384
1 0.5156664384404384
2 0.492923664081269
1 0.492923664081269
2 0.4717175608490118
1 0.4717175608490118
2 0.45193613597668136
1 0.45193613597668136
2 0.4334728282023538
1 0.4334728282023538
2 0.41622722029151793
1 0.41622722029151793
2 0.4001053975323474
1 0.4001053975323474
2 0.3850200448917678
1 0.3850200448917678
2 0.37089035684502436
1 0.37089035684502436
2 0.3576418184080819
1 0.3576418184080819
2 0.34520590222269204
1 0.34520590222269204
2 0.33351971544489745
1 0.33351971544489745
2 0.322525621241482
1 0.322525621241482
2 0.3121708526980101
1 0.3121708526980101
2 0.3024071315539397
1 0.3024071315539397
2 0.29319030010554603
1 0.29319030010554603
2 0.2844799715860995
1 0.2844799715860995
2 0.2762392021152053
1 0.2762392021152053
2 0.2684341857167639
1 0.2684341857167639
2 0.2610339727861709
1 0.2610339727861709
2 0.25401021162284554
1 0.25401021162284554
2 0.24733691214140857
1 0.24733691214140857
2 0.24099023056296048
1 0.24099023056296048
2 0.23494827371322163
1 0.23494827371322163
2 0.22919092147650288
1 0.22919092147650288
2 0.22369966594364551
1 0.22369966594364551
2 0.21845746582621786
1 0.21845746582621786
2 0.21344861477230728
1 0.21344861477230728
2 0.2086586222996882
1 0.2086586222996882
2 0.20407410615181754
1 0.20407410615181754
2 0.19968269497523475
1 0.19968269497523475
2 0.19547294030973442
1 0.19547294030973442
2 0.19143423697246154
1 0.19143423697246154
2 0.1875567510023663
1 0.1875567510023663
2 0.18383135441119708
1 0.18383135441119708
2 0.18024956606106665
1 0.18024956606106665
2 0.1768034980563862
1 0.1768034980563862
2 0.17348580709979708
1 0.17348580709979708
2 0.17028965031782659
1 0.17028965031782659
2 0.16720864511271555
1 0.16720864511271555
2 0.16423683264258154
1 0.16423683264258154
2 0.1613686445731633
1 0.1613686445731633
2 0.1585988727812876
1 0.1585988727812876
2 0.15592264172323095
1 0.15592264172323095
2 0.15333538321073928
1 0.15333538321073928
2 0.1508328133639211
1 0.1508328133639211
2 0.1484109115338984
1 0.1484109115338984
2 0.14606590100921885
1 0.14606590100921885
2 0.1437942313389467
1 0.1437942313389467
2 0.14159256212222288
1 0.14159256212222288
2 0.13945774812917197
1 0.13945774812917197
2 0.13738682563152932
1 0.13738682563152932
2 0.13537699983342816
1 0.13537699983342816
2 0.13342563330357016
1 0.13342563330357016
2 0.1315302353196771
1 0.1315302353196771
2 0.12968845204476773
1 0.12968845204476773
2 0.12789805746255833
1 0.12789805746255833
2 0.12615694500624866
1 0.12615694500624866
2 0.1244631198211787
1 0.1244631198211787
2 0.12281469160746512
1 0.12281469160746512
2 0.12120986799373766
1 0.12120986799373766
2 0.11964694839765348
1 0.11964694839765348
2 0.11812431833290656
1 0.11812431833290656
2 0.1166404441261519
1 0.1166404441261519
2 0.11519386801055143
1 0.11519386801055143
2 0.11378320356563737
1 0.11378320356563737
2 0.11240713147588999
1 0.11240713147588999
2 0.11106439558284413
1 0.11106439558284413
2 0.10975379920775852
1 0.10975379920775852
2 0.10847420172385769
1 0.10847420172385769
2 0.10722451535896507
1 0.10722451535896507
2 0.10600370221098382
1 0.10600370221098382
2 0.10481077146016096
1 0.10481077146016096
2 0.10364477676340979
1 0.10364477676340979
2 0.10250481381720782
1 0.10250481381720782
2 0.10139001807667275
1 0.10139001807667275
2 0.10029956261945305
1 0.10029956261945305
2 0.09923265614397955
1 0.09923265614397955
2 0.09818854109246641
1 0.09818854109246641
2 0.09716649188981615
1 0.09716649188981615
2 0.09616581329027897
1 0.09616581329027897
2 0.0951858388243665
1 0.0951858388243665
2 0.09422592933908054
1 0.09422592933908054
2 0.09328547162508034
1 0.09328547162508034
2 0.09236387712487303
1 0.09236387712487303
2 0.09146058071658031
1 0.09146058071658031
2 0.09057503956823337
1 0.09057503956823337
2 0.08970673205792526
1 0.08970673205792526
2 0.08885515675549979
1 0.08885515675549979
2 0.08801983146177045
1 0.08801983146177045
2 0.0872002923015544
1 0.0872002923015544
2 0.08639609286707867
1 0.08639609286707867
2 0.08560680340855142
1 0.08560680340855142
2 0.08483201006893884
1 0.08483201006893884
2 0.0840713141601759
1 0.0840713141601759
2 0.083324331478244
1 0.083324331478244
2 0.08259069165473479
1 0.08259069165473479
2 0.08187003754265873
1 0.08187003754265873
2 0.08116202463444003
1 0.08116202463444003
2 0.08046632051015745
1 0.08046632051015745
2 0.07978260431423295
1 0.07978260431423295
2 0.07911056625888166
1 0.07911056625888166
2 0.07844990715275939
1 0.07844990715275939
2 0.07780033795333544
1 0.07780033795333544
2 0.07716157934162415
1 0.07716157934162415
2 0.07653336131799099
1 0.07653336131799099
2 0.0759154228178347
1 0.0759154228178347
2 0.07530751134602151
1 0.07530751134602151
2 0.07470938262902485
1 0.07470938262902485
2 0.0741208002837801
1 0.0741208002837801
2 0.07354153550233375
1 0.07354153550233375
2 0.07297136675142007
1 0.07297136675142007
2 0.07241007948615516
1 0.07241007948615516
2 0.07185746587708203
1 0.07185746587708203
2 0.07131332454985323
1 0.07131332454985323
2 0.07077746033687435
1 0.07077746033687435
2 0.07024968404028376
1 0.07024968404028376
2 0.06972981220566077
1 0.06972981220566077
2 0.06921766690591578
1 0.06921766690591578
2 0.06871307553482486
1 0.06871307553482486
2 0.06821587060972044
1 0.06821587060972044
2 0.06772588958286505
1 0.06772588958286505
2 0.06724297466107174
1 0.06724297466107174
2 0.06676697263315097
1 0.06676697263315097
2 0.0662977347047993
1 0.0662977347047993
2 0.06583511634055468
1 0.06583511634055468
2 0.0653789771124686
1 0.0653789771124686
2 0.0649291805551725
1 0.0649291805551725
2 0.06448559402701956
1 0.06448559402701956
2 0.06404808857701351
1 0.06404808857701351
2 0.06361653881724003
1 0.06361653881724003
2 0.06319082280054779
1 0.06319082280054779
2 0.06277082190321892
1 0.06277082190321892
2 0.062356420712400634
1 0.062356420712400634
2 0.06194750691807504
1 0.06194750691807504
2 0.06154397120935142
1 0.06154397120935142
2 0.06114570717488588
1 0.06114570717488588
2 0.06075261120723659
1 0.06075261120723659
2 0.0603645824109741
1 0.0603645824109741
2 0.05998152251437869
1 0.05998152251437869
2 0.059603335784559085
1 0.059603335784559085
2 0.05922992894584676
1 0.05922992894584676
2 0.058861211101308965
1 0.058861211101308965
2 0.058497093657253516
1 0.058497093657253516
2 0.05813749025058463
1 0.05813749025058463
2 0.05778231667889221
1 0.05778231667889221
2 0.057431490833150835
1 0.057431490833150835
2 0.05708493263291798
1 0.05708493263291798
2 0.05674256396392446
1 0.05674256396392446
2 0.056404308617952384
1 0.056404308617952384
2 0.056070092234907484
1 0.056070092234907484
2 0.055739842246989205
1 0.055739842246989205
2 0.05541348782487298
1 0.05541348782487298
2 0.0550909598258216
1 0.0550909598258216
2 0.054772190743641695
1 0.054772190743641695
2 0.054457114660413405
1 0.054457114660413405
2 0.054145667199919326
1 0.054145667199919326
2 0.053837785482701975
1 0.053837785482701975
2 0.053533408082685835
1 0.053533408082685835
2 0.053232474985298636
1 0.053232474985298636
2 0.052934927547035784
1 0.052934927547035784
2 0.05264070845640519
1 0.05264070845640519
2 0.0523497616962012
1 0.0523497616962012
2 0.0520620325070556
1 0.0520620325070556
2 0.05177746735221201
1 0.05177746735221201
2 0.05149601388348198
1 0.05149601388348198
2 0.05121762090832971
1 0.05121762090832971
2 0.05094223835804782
1 0.05094223835804782
2 0.050669817256980915
1 0.050669817256980915
2 0.05040030969275325
1 0.05040030969275325
2 0.05013366878746803
1 0.05013366878746803
2 0.049869848669836854
1 0.049869848669836854
2 0.04960880444820972
1 0.04960880444820972
2 0.04935049218446432
1 0.04935049218446432
2 0.04909486886873041
1 0.04909486886873041
2 0.04884189239491496
1 0.04884189239491496
2 0.04859152153699634
1 0.04859152153699634
2 0.04834371592606515
1 0.04834371592606515
2 0.04809843602807761
1 0.04809843602807761
2 0.04785564312230331
1 0.04785564312230331
2 0.047615299280435515
1 0.047615299280435515
2 0.04737736734634324
1 0.04737736734634324
2 0.0471418109164447
1 0.0471418109164447
2 0.04690859432067324
1 0.04690859432067324
2 0.046677682604023024
1 0.046677682604023024
2 0.04644904150864841
1 0.04644904150864841
2 0.04622263745649882
1 0.04622263745649882
2 0.04599843753247265
1 0.04599843753247265
2 0.04577640946806963
1 0.04577640946806963
2 0.04555652162552539
1 0.04555652162552539
2 0.04533874298241285
1 0.04533874298241285
2 0.04512304311669235
1 0.04512304311669235
2 0.044909392192197924
1 0.044909392192197924
2 0.044697760944540255
1 0.044697760944540255
2 0.04448812066742183
1 0.04448812066742183
2 0.044280443199336175
1 0.044280443199336175
2 0.044074700910653665
1 0.044074700910653665
2 0.04387086669106882
1 0.04387086669106882
2 0.04366891393740546
1 0.04366891393740546
2 0.04346881654176259
1 0.04346881654176259
2 0.04327054887999378
1 0.04327054887999378
2 0.04307408580050484
1 0.04307408580050484
2 0.04287940261336684
1 0.04287940261336684
2 0.04268647507972291
1 0.04268647507972291
2 0.042495279401492586
1 0.042495279401492586
2 0.042305792211352986
1 0.042305792211352986
2 0.042117990562995394
1 0.042117990562995394
2 0.041931851921643254
1 0.041931851921643254
2 0.04174735415483004
1 0.04174735415483004
2 0.04156447552341988
1 0.04156447552341988
2 0.041383194672871694
1 0.041383194672871694
2 0.04120349062473401
1 0.04120349062473401
2 0.041025342768366384
1 0.041025342768366384
2 0.04084873085287727
1 0.04084873085287727
2 0.04067363497927647
1 0.04067363497927647
2 0.040500035592828165
1 0.040500035592828165
2 0.04032791347561007
1 0.04032791347561007
2 0.040157249739256495
1 0.040157249739256495
2 0.03998802581789661
1 0.03998802581789661
2 0.039820223461268595
1 0.039820223461268595
2 0.03965382472801458
1 0.03965382472801458
2 0.039488811979141024
1 0.039488811979141024
2 0.03932516787164972
1 0.03932516787164972
2 0.03916287535232772
1 0.03916287535232772
2 0.03900191765169167
1 0.03900191765169167
2 0.038842278278087485
1 0.038842278278087485
2 0.03868394101193436
1 0.03868394101193436
2 0.03852688990011202
1 0.03852688990011202
2 0.03837110925048773
1 0.03837110925048773
2 0.03821658362657808
1 0.03821658362657808
2 0.03806329784233918
1 0.03806329784233918
2 0.037911236957088895
1 0.037911236957088895
2 0.037760386270546814
1 0.037760386270546814
2 0.03761073131799964
1 0.03761073131799964
2 0.03746225786557907
1 0.03746225786557907
2 0.03731495190565575
1 0.03731495190565575
2 0.03716879965234228
1 0.03716879965234228
2 0.03702378753710382
1 0.03702378753710382
2 0.03687990220447196
1 0.03687990220447196
2 0.03673713050786233
1 0.03673713050786233
2 0.03659545950548644
1 0.03659545950548644
2 0.036454876456364436
1 0.036454876456364436
2 0.036315368816427135
1 0.036315368816427135
2 0.03617692423471082
1 0.03617692423471082
2 0.036039530549639
1 0.036039530549639
2 0.03590317578539042
1 0.03590317578539042
2 0.03576784814835194
1 0.03576784814835194
2 0.0356335360236502
1 0.0356335360236502
2 0.03550022797176401
1 0.03550022797176401
2 0.035367912725214584
1 0.035367912725214584
2 0.03523657918532718
1 0.03523657918532718
2 0.03510621641907076
1 0.03510621641907076
2 0.0349768136559641
1 0.0349768136559641
2 0.03484836028505446
1 0.03484836028505446
2 0.034720845851962216
1 0.034720845851962216
2 0.034594260055990034
1 0.034594260055990034
2 0.034468592747298875
1 0.034468592747298875
2 0.034343833924143724
1 0.034343833924143724
2 0.034219973730171924
1 0.034219973730171924
2 0.03409700245177765
1 0.03409700245177765
2 0.03397491051551931
1 0.03397491051551931
2 0.03385368848558711
1 0.03385368848558711
2 0.033733327061329685
1 0.033733327061329685
2 0.033613817074832186
1 0.033613817074832186
2 0.03349514948854769
1 0.03349514948854769
2 0.033377315392976274
1 0.033377315392976274
2 0.03326030600439939
1 0.03326030600439939
2 0.03314411266265565
1 0.03314411266265565
2 0.0330287268289683
1 0.0330287268289683
2 0.032914140083817274
1 0.032914140083817274
2 0.03280034412485547
1 0.03280034412485547
2 0.032687330764870175
1 0.032687330764870175
2 0.032575091929784215
1 0.032575091929784215
2 0.03246361965670187
1 0.03246361965670187
2 0.032352906091993996
1 0.032352906091993996
2 0.03224294348942229
1 0.03224294348942229
2 0.03213372420830199
1 0.03213372420830199
2 0.03202524071170409
1 0.03202524071170409
2 0.03191748556469216
1 0.03191748556469216
2 0.03181045143259671
1 0.03181045143259671
2 0.03170413107932238
1 0.03170413107932238
2 0.031598517365693274
1 0.031598517365693274
2 0.03149360324782786
1 0.03149360324782786
2 0.03138938177554766
1 0.03138938177554766
2 0.03128584609081893
1 0.03128584609081893
2 0.031182989426224314
1 0.031182989426224314
2 0.03108080510346623
1 0.03108080510346623
2 0.030979286531896355
1 0.030979286531896355
2 0.030878427207080145
1 0.030878427207080145
2 0.03077822070938408
1 0.03077822070938408
2 0.030678660702592637
1 0.030678660702592637
2 0.03057974093255443
1 0.03057974093255443
2 0.03048145522585116
1 0.03048145522585116
2 0.030383797488494436
1 0.030383797488494436
2 0.030286761704647856
1 0.030286761704647856
2 0.030190341935373878
1 0.030190341935373878
2 0.030094532317402733
1 0.030094532317402733
2 0.029999327061928323
1 0.029999327061928323
2 0.029904720453424974
1 0.029904720453424974
2 0.02981070684848619
1 0.02981070684848619
2 0.029717280674687974
1 0.029717280674687974
2 0.029624436429471258
1 0.029624436429471258
2 0.029532168679046192
1 0.029532168679046192
2 0.029440472057317965
1 0.029440472057317965
2 0.029349341264830676
1 0.029349341264830676
2 0.02925877106773448
1 0.02925877106773448
2 0.029168756296768024
1 0.029168756296768024
2 0.02907929184626151
1 0.02907929184626151
2 0.02899037267315929
1 0.02899037267315929
2 0.02890199379605863
1 0.02890199379605863
2 0.028814150294267957
1 0.028814150294267957
2 0.028726837306880033
1 0.028726837306880033
2 0.02864005003186561
1 0.02864005003186561
2 0.02855378372517897
1 0.02855378372517897
2 0.028468033699884487
1 0.028468033699884487
2 0.028382795325295536
1 0.028382795325295536
2 0.028298064026130425
1 0.028298064026130425
2 0.02821383528168333
1 0.02821383528168333
2 0.028130104625011136
1 0.028130104625011136
2 0.02804686764213198
1 0.02804686764213198
2 0.02796411997124145
1 0.02796411997124145
2 0.02788185730193979
1 0.02788185730193979
2 0.027800075374476457
1 0.027800075374476457
2 0.027718769979003813
1 0.027718769979003813
2 0.02763793695484646
1 0.02763793695484646
2 0.027557572189783074
1 0.027557572189783074
2 0.02747767161934178
1 0.02747767161934178
2 0.02739823122610483
1 0.02739823122610483
2 0.02731924703902827
1 0.02731924703902827
2 0.027240715132773107
1 0.027240715132773107
2 0.02716263162704707
1 0.02716263162704707
2 0.027084992685956828
1 0.027084992685956828
2 0.027007794517374988
1 0.027007794517374988
2 0.026931033372314124
1 0.026931033372314124
2 0.026854705544312824
1 0.026854705544312824
2 0.026778807368833545
1 0.026778807368833545
2 0.026703335222669246
1 0.026703335222669246
2 0.026628285523359593
1 0.026628285523359593
2 0.02655365472861869
1 0.02655365472861869
2 0.02647943933577254
1 0.02647943933577254
2 0.02640563588120285
1 0.02640563588120285
2 0.02633224093980458
1 0.02633224093980458
2 0.02625925112444973
1 0.02625925112444973
2 0.02618666308546049
1 0.02618666308546049
2 0.02611447351009077
1 0.02611447351009077
2 0.026042679122019418
1 0.026042679122019418
2 0.025971276680847217
1 0.025971276680847217
2 0.025900262981604676
1 0.025900262981604676
2 0.025829634854268424
1 0.025829634854268424
2 0.02575938916328456
1 0.02575938916328456
2 0.02568952280709917
1 0.02568952280709917
2 0.02562003271769778
1 0.02562003271769778
2 0.02555091586015333
1 0.02555091586015333
2 0.025482169232176718
1 0.025482169232176718
2 0.02541378986368143
1 0.02541378986368143
2 0.02534577481634894
1 0.02534577481634894
2 0.025278121183205646
1 0.025278121183205646
2 0.025210826088203554
1 0.025210826088203554
2 0.02514388668580942
1 0.02514388668580942
2 0.02507730016060092
1 0.02507730016060092
2 0.025011063726865713
1 0.025011063726865713
2 0.02494517462821215
1 0.02494517462821215
2 0.02487963013718157
1 0.02487963013718157
2 0.024814427554869952
1 0.024814427554869952
2 0.024749564210552556
1 0.024749564210552556
2 0.024685037461317512
1 0.024685037461317512
2 0.024620844691702577
1 0.024620844691702577
2 0.02455698331333964
1 0.02455698331333964
2 0.02449345076460327
1 0.02449345076460327
2 0.02443024451026531
1 0.02443024451026531
2 0.024367362041154243
1 0.024367362041154243
2 0.02430480087382166
1 0.02430480087382166
2 0.024242558550211818
1 0.024242558550211818
2 0.024180632637336115
1 0.024180632637336115
2 0.024119020726955074
1 0.024119020726955074
2 0.024057720435263365
1 0.024057720435263365
2 0.02399672940257796
1 0.02399672940257796
2 0.023936045293035797
1 0.023936045293035797
2 0.023875665794291383
1 0.023875665794291383
2 0.02381558861722026
1 0.02381558861722026
2 0.023755811495629692
1 0.023755811495629692
2 0.02369633218596924
1 0.02369633218596924
2 0.023637148467049132
1 0.023637148467049132
2 0.02357825813976122
1 0.02357825813976122
2 0.023519659026804904
1 0.023519659026804904
2 0.023461348972415887
1 0.023461348972415887
2 0.023403325842101592
1 0.023403325842101592
2 0.023345587522376636
1 0.023345587522376636
2 0.023288131920506296
1 0.023288131920506296
2 0.0232309569642499
1 0.0232309569642499
2 0.023174060601611667
1 0.023174060601611667
2 0.02311744080059281
1 0.02311744080059281
2 0.02306109554894751
1 0.02306109554894751
2 0.02300502285394304
1 0.02300502285394304
2 0.022949220742124125
1 0.022949220742124125
2 0.022893687259078945
1 0.022893687259078945
2 0.022838420469208632
1 0.022838420469208632
2 0.022783418455503104
1 0.022783418455503104
2 0.022728679319315305
1 0.022728679319315305
2 0.022674201180143877
1 0.022674201180143877
2 0.0226199821754146
1 0.0226199821754146
2 0.022566020460267296
1 0.022566020460267296
2 0.022512314207344862
1 0.022512314207344862
2 0.0224588616065867
1 0.0224588616065867
2 0.02240566086502331
1 0.02240566086502331
2 0.022352710206574297
1 0.022352710206574297
2 0.022300007871850276
1 0.022300007871850276
2 0.02224755211795644
1 0.02224755211795644
2 0.022195341218298782
1 0.022195341218298782
2 0.022143373462394544
1 0.022143373462394544
2 0.022091647155683566
1 0.022091647155683566
2 0.022040160619343118
1 0.022040160619343118
2 0.021988912190105382
1 0.021988912190105382
2 0.02193790022007716
1 0.02193790022007716
2 0.0218871230765622
1 0.0218871230765622
2 0.021836579141886452
1 0.021836579141886452
2 0.021786266813224837
1 0.021786266813224837
2 0.021736184502430676
1 0.021736184502430676
2 0.02168633063586876
1 0.02168633063586876
2 0.021636703654247576
1 0.021636703654247576
2 0.0215873020124592
1 0.0215873020124592
2 0.021538124179413927
1 0.021538124179413927
2 0.021489168637884394
1 0.021489168637884394
2 0.021440433884348842
1 0.021440433884348842
2 0.0213919184288326
1 0.0213919184288326
2 0.021343620794760695
1 0.021343620794760695
2 0.021295539518803627
1 0.021295539518803627
2 0.02124767315072991
1 0.02124767315072991
2 0.02120002025325951
1 0.02120002025325951
2 0.021152579401920224
1 0.021152579401920224
2 0.021105349184903623
1 0.021105349184903623
2 0.021058328202924595
1 0.021058328202924595
2 0.021011515069083067
1 0.021011515069083067
2 0.020964908408727372
1 0.020964908408727372
2 0.020918506859317447
1 0.020918506859317447
2 0.020872309070293305
1 0.020872309070293305
2 0.020826313702941843
1 0.020826313702941843
2 0.020780519430268134
1 0.020780519430268134
2 0.0207349249368672
1 0.0207349249368672
2 0.020689528918796253
1 0.020689528918796253
2 0.02064433008345018
1 0.02064433008345018
2 0.020599327149441186
1 0.020599327149441186
2 0.020554518846472226
1 0.020554518846472226
2 0.02050990391522158
1 0.02050990391522158
2 0.02046548110722067
1 0.02046548110722067
2 0.020421249184740593
1 0.020421249184740593
2 0.020377206920673664
1 0.020377206920673664
2 0.020333353098421852
1 0.020333353098421852
2 0.020289686511782503
1 0.020289686511782503
2 0.02024620596483785
1 0.02024620596483785
2 0.020202910271847424
1 0.020202910271847424
2 0.020159798257135507
1 0.020159798257135507
2 0.02011686875498924
1 0.02011686875498924
2 0.020074120609549048
1 0.020074120609549048
2 0.02003155267470822
1 0.02003155267470822
2 0.019989163814005912
1 0.019989163814005912
2 0.0199469529005297
1 0.0199469529005297
2 0.019904918816813374
1 0.019904918816813374
2 0.01986306045473709
1 0.01986306045473709
2 0.019821376715432576
1 0.019821376715432576
2 0.019779866509183265
1 0.019779866509183265
2 0.01973852875533136
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.0058137 ],
       [0.99552735],
       [0.99552913],
       [0.00493209]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0],
       [1],
       [1],
       [0]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([[1.76405235, 0.40015721],
        [0.97873798, 2.2408932 ]]), array([[ 0.95008842, -0.15135721]])]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([[ 1.86755799],
        [-0.97727788]]), array([[-0.10321885]])]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>                 <span class="c1"># Define a function</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">autograd</span> <span class="kn">import</span> <span class="n">elementwise_grad</span> <span class="k">as</span> <span class="n">egrad</span>
<span class="kn">from</span> <span class="nn">autograd</span> <span class="kn">import</span> <span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_tanh</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">tanh</span><span class="p">)</span>
<span class="n">grad_sigmoid</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.41997434])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_sigmoid</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.19661193324148188</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sigmoid</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sigmoid</span><span class="p">(</span><span class="mf">1.</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.19661193324148185</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">@</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">activation_func</span><span class="p">[</span><span class="n">activations</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]](</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y_hat</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="nd">@np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y_hat</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_objective</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">argnum</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_objective</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
Autograd ArrayBox with value [[ 1.86755799e+00 -9.77277880e-01]
 [ 2.26771520e+00  1.26361532e+00]
 [ 3.63161034e+00  1.46010423e-03]
 [ 4.03176754e+00  2.24235330e+00]] Autograd ArrayBox with value [[0.86617546 0.27343225]
 [0.9061677  0.77964784]
 [0.97420925 0.50036503]
 [0.98256638 0.9039889 ]]
2
Autograd ArrayBox with value [[0.67833848]
 [0.63971526]
 [0.74663222]
 [0.69348085]] Autograd ArrayBox with value [[0.66336776]
 [0.65468909]
 [0.67844443]
 [0.66674081]]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([array([[ 0.003175  , -0.01704455],
         [ 0.00340863,  0.00022022]]), array([[0.60353799, 0.35399637]])],
 [array([[ 0.04833612],
         [-0.00755961]]), array([[0.6632421]])])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span>  <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="nd">@A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Autograd ArrayBox with value [[0.60353799 0.35399637]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">((</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Autograd ArrayBox with value [[0.6632421]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Both-the-above-seem-correct">
<a class="anchor" href="#Both-the-above-seem-correct" aria-hidden="true"><span class="octicon octicon-link"></span></a>Both the above seem correct<a class="anchor-link" href="#Both-the-above-seem-correct"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dela</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="nd">@W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">delz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dela</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">delz</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Autograd ArrayBox with value [[ 0.07305669 -0.01994726]
 [-0.02789557  0.00897903]
 [-0.00767602  0.01216743]
 [ 0.01085102 -0.0087588 ]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">delz</span><span class="o">.</span><span class="n">T</span><span class="nd">@A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Autograd ArrayBox with value [[ 0.003175   -0.01704455]
 [ 0.00340863  0.00022022]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="nipunbatra/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/ml/2020/02/28/xor-relu-vector.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Sustainability Lab Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Sustainability Lab Blog</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <li><a href="https://github.com/nipunbatra"><svg class="social svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">nipunbatra</span></a></li><li><a href="https://www.twitter.com/nipun_batra"><svg class="social svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">nipun_batra</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This blog contains mostly articles about machine learning, sensor networks, academia</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
